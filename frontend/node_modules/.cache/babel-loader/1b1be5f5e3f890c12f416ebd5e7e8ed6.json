{"ast":null,"code":"import _slicedToArray from \"/home/xiaochen/Downloads/cs316project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/home/xiaochen/Downloads/cs316project/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/xiaochen/Downloads/cs316project/frontend/src/components/Search.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport clsx from 'clsx';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { useStateValue } from '../state';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { useHistory } from \"react-router-dom\";\nconst useStyles = makeStyles(theme => ({\n  container: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '2px 4px'\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1)\n  },\n  iconButton: {\n    padding: 10\n  },\n  search: {\n    color: 'black'\n  }\n}));\n\nconst parseWagePosting = posting => {\n  return {\n    company: posting.employer,\n    location: posting.city,\n    position: posting.position,\n    year: posting.year,\n    wage: posting.wage,\n    id: posting.id\n  };\n};\n\nconst fetchSearchResult = async (job, location) => {\n  const url = \"http://67.159.88.90:8000/api/wages/?city=\" + location + \"&position=\" + job;\n  let wageInfo = await axios.get(url);\n\n  if (!wageInfo || !wageInfo.data || !wageInfo.data.results || wageInfo.data.results.length === 0) {\n    return null;\n  }\n\n  return _objectSpread({}, wageInfo.data, {\n    results: wageInfo.data.results.map(item => parseWagePosting(item))\n  });\n};\n\nconst fetchHousingResult = async location => {\n  const url = \"http://67.159.88.90:8000/api/housingsummary/?city=\" + location;\n  let housingInfo = await axios.get(url);\n\n  if (!housingInfo || !housingInfo.data) {\n    return null;\n  }\n\n  return housingInfo.data;\n};\n\nconst fetchWageResult = async (job, location) => {\n  const url = \"http://67.159.88.90:8000/api/wagesummary/?city=\" + location + \"&position=\" + job;\n  let wageInfo = await axios.get(url);\n\n  if (!wageInfo || !wageInfo.data) {\n    return null;\n  }\n\n  return wageInfo.data;\n};\n\nconst Search = () => {\n  const history = useHistory();\n\n  const _useStateValue = useStateValue(),\n        _useStateValue2 = _slicedToArray(_useStateValue, 2),\n        searchResult = _useStateValue2[0].searchResult,\n        dispatch = _useStateValue2[1];\n\n  const _React$useState = React.useState({\n    location: '',\n    job: ''\n  }),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        values = _React$useState2[0],\n        setValues = _React$useState2[1];\n\n  const handleChange = name => event => {\n    setValues(_objectSpread({}, values, {\n      [name]: event.target.value\n    }));\n  };\n\n  const classes = useStyles();\n\n  const submitSearch = async () => {\n    dispatch({\n      type: 'updateSearchQuery',\n      searchQuery: {\n        location: values.location,\n        job: values.job\n      }\n    });\n    const housingResult = await fetchHousingResult(values.location);\n    dispatch({\n      type: 'updateHousingResult',\n      housingResult: housingResult\n    });\n    const result = await fetchSearchResult(values.job, values.location);\n    dispatch({\n      type: 'updateSearchResult',\n      searchResult: result\n    });\n    const wageResult = await fetchWageResult(values.job, values.location);\n    dispatch({\n      type: 'updateWageResult',\n      wageResult: wageResult\n    });\n  };\n\n  const handle = event => {\n    if (event.key === 'Enter') {\n      submitSearch();\n      history.push(\"/result\");\n    }\n  };\n\n  return React.createElement(\"form\", {\n    className: classes.container,\n    noValidate: true,\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    id: \"outlined-location\",\n    label: \"Location\",\n    className: classes.textField,\n    value: values.location,\n    onChange: handleChange('location'),\n    margin: \"normal\",\n    variant: \"outlined\",\n    onKeyPress: e => handle(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }), React.createElement(TextField, {\n    id: \"outlined-job\",\n    label: \"Job position\",\n    className: classes.textField,\n    value: values.job,\n    onChange: handleChange('job'),\n    margin: \"normal\",\n    variant: \"outlined\",\n    onKeyPress: e => handle(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }), React.createElement(IconButton, {\n    className: classes.iconButton,\n    \"aria-label\": \"search\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(Link, {\n    className: classes.search,\n    to: \"/result\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(SearchIcon, {\n    id: \"search\",\n    onClick: submitSearch,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }))));\n};\n\nexport default Search;","map":{"version":3,"sources":["/home/xiaochen/Downloads/cs316project/frontend/src/components/Search.js"],"names":["React","makeStyles","clsx","MenuItem","TextField","IconButton","SearchIcon","useStateValue","Link","axios","useHistory","useStyles","theme","container","flexGrow","display","flexDirection","alignItems","justifyContent","padding","textField","marginLeft","spacing","marginRight","iconButton","search","color","parseWagePosting","posting","company","employer","location","city","position","year","wage","id","fetchSearchResult","job","url","wageInfo","get","data","results","length","map","item","fetchHousingResult","housingInfo","fetchWageResult","Search","history","searchResult","dispatch","useState","values","setValues","handleChange","name","event","target","value","classes","submitSearch","type","searchQuery","housingResult","result","wageResult","handle","key","push","e"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport clsx from 'clsx';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { useStateValue } from '../state'\nimport { Link } from 'react-router-dom'\nimport axios from 'axios'\nimport { useHistory } from \"react-router-dom\";\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      flexGrow: 1, \n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: '2px 4px',\n    },\n    textField: {\n      marginLeft: theme.spacing(1),\n      marginRight: theme.spacing(1),\n    },\n    iconButton: {\n        padding: 10,\n      },\n    search: {\n        color: 'black',\n    }\n  }));\n\nconst parseWagePosting = (posting) => {\n    return {\n        company: posting.employer, \n        location: posting.city, \n        position: posting.position,\n        year: posting.year, \n        wage: posting.wage,\n        id: posting.id, \n    }\n}\n\nconst fetchSearchResult = async (job, location) => {\n     const url = \"http://67.159.88.90:8000/api/wages/?city=\" + location + \"&position=\" + job;\n     let wageInfo = await axios.get(url);\n\n     if (!wageInfo || !wageInfo.data || !wageInfo.data.results || wageInfo.data.results.length === 0) {\n         return null;\n     }\n     \n     return {\n        ...wageInfo.data,\n        results: wageInfo.data.results.map(item => \n            parseWagePosting(item)),\n     };\n}\n\nconst fetchHousingResult = async (location) => {\n    const url = \"http://67.159.88.90:8000/api/housingsummary/?city=\" + location;\n    let housingInfo = await axios.get(url);\n\n    if (!housingInfo || !housingInfo.data) {\n        return null;\n    } \n\n    return housingInfo.data;\n}\n\nconst fetchWageResult = async (job, location) => {\n    const url = \"http://67.159.88.90:8000/api/wagesummary/?city=\" + location + \"&position=\" + job;\n    let wageInfo = await axios.get(url);\n\n    if (!wageInfo || !wageInfo.data) {\n        return null;\n    } \n\n    return wageInfo.data;\n}\n\n\n\nconst Search = () => {\n    const history = useHistory();\n    const [{ searchResult }, dispatch] = useStateValue();\n    const [values, setValues] = React.useState({\n        location: '',\n        job: '',\n      });\n    const handleChange = name => event => {\n        setValues({ ...values, [name]: event.target.value });\n    };\n    const classes = useStyles();\n\n    const submitSearch = async () => {\n        dispatch({\n            type: 'updateSearchQuery',\n            searchQuery: {location: values.location, job: values.job}\n        });\n        const housingResult = await fetchHousingResult(values.location);\n        dispatch({\n            type: 'updateHousingResult',\n            housingResult: housingResult, \n        })\n        \n        const result = await fetchSearchResult(values.job, values.location);\n        dispatch({\n            type: 'updateSearchResult',\n            searchResult: result,\n        });\n        const wageResult = await fetchWageResult(values.job, values.location);\n        dispatch({\n            type: 'updateWageResult',\n            wageResult: wageResult,\n        });\n    };\n\n    const handle = (event) => {\n        if (event.key === 'Enter') {\n            submitSearch();\n            history.push(\"/result\");\n        }\n    }\n\n    return(\n        <form className={classes.container} noValidate autoComplete=\"off\">\n            <TextField\n                id=\"outlined-location\"\n                label=\"Location\"\n                className={classes.textField}\n                value={values.location}\n                onChange={handleChange('location')}\n                margin=\"normal\"\n                variant=\"outlined\"\n                onKeyPress={(e)=>handle(e)}\n            />\n            <TextField\n                id=\"outlined-job\"\n                label=\"Job position\"\n                className={classes.textField}\n                value={values.job}\n                onChange={handleChange('job')}\n                margin=\"normal\"\n                variant=\"outlined\"\n                onKeyPress={(e)=>handle(e)}\n            />\n            <IconButton className={classes.iconButton} aria-label=\"search\">\n                <Link className={classes.search} to=\"/result\">\n                    <SearchIcon\n                    id=\"search\"\n                    onClick={submitSearch}\n                    />\n                </Link>\n            </IconButton>\n        </form>\n    );\n}\nexport default Search;"]},"metadata":{},"sourceType":"module"}